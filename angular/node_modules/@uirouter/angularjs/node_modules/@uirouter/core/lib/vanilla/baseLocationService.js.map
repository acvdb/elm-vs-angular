{"version":3,"file":"baseLocationService.js","sourceRoot":"","sources":["@uirouter/core/vanilla/baseLocationService.ts"],"names":[],"mappings":";AAAA;;;GAGG,CAAC,MAAM;;AAMV,iCAAwD;AACxD,mDAAiD;AACjD,2CAAgE;AAChE,gCAAgC;AAChC;IACE,8BAAY,MAAgB,EAAS,eAAwB;QAA7D,iBAGC;QAHoC,oBAAe,GAAf,eAAe,CAAS;QAK7D,cAAS,GAAG,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,EAAE,IAAI,OAAA,EAAE,CAAC,GAAG,CAAC,EAAP,CAAO,CAAC,EAAtC,CAAsC,CAAC;QAElD,eAAU,GAAe,EAAE,CAAC;QA+BpC,SAAI,GAAK,cAAM,OAAA,gBAAQ,CAAC,KAAI,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,EAA1B,CAA0B,CAAC;QAC1C,SAAI,GAAK,cAAM,OAAA,gBAAQ,CAAC,KAAI,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,EAA1B,CAA0B,CAAC;QAC1C,WAAM,GAAG,cAAM,OAAA,iBAAS,CAAC,gBAAQ,CAAC,KAAI,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,CAAC,EAAvC,CAAuC,CAAC;QAvCrD,IAAI,CAAC,SAAS,GAAG,MAAM,IAAI,MAAM,CAAC,QAAQ,CAAC;QAC3C,IAAI,CAAC,QAAQ,GAAG,MAAM,IAAI,MAAM,CAAC,OAAO,CAAC;IAC3C,CAAC;IAuCD,kCAAG,GAAH,UAAI,GAAY,EAAE,OAAuB;QAAvB,wBAAA,EAAA,cAAuB;QACvC,EAAE,CAAC,CAAC,sBAAS,CAAC,GAAG,CAAC,IAAI,GAAG,KAAK,IAAI,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1C,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,GAAG,EAAE,OAAO,CAAC,CAAC;YAEpC,EAAE,CAAC,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,CAAC;gBACzB,IAAI,KAAG,GAAG,eAAM,CAAC,IAAI,KAAK,CAAC,gBAAgB,CAAC,EAAE,EAAE,GAAG,KAAA,EAAE,CAAC,CAAC;gBACvD,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,UAAA,EAAE,IAAI,OAAA,EAAE,CAAC,KAAG,CAAC,EAAP,CAAO,CAAC,CAAC;YACzC,CAAC;QACH,CAAC;QAED,MAAM,CAAC,gBAAQ,CAAC,IAAI,CAAC,CAAC;IACxB,CAAC;IAED,uCAAQ,GAAR,UAAS,EAAiB;QAA1B,iBAGC;QAFC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACzB,MAAM,CAAC,cAAM,OAAA,mBAAU,CAAC,KAAI,CAAC,UAAU,EAAE,EAAE,CAAC,EAA/B,CAA+B,CAAC;IAC/C,CAAC;IAED,sCAAO,GAAP,UAAQ,MAAgB;QACtB,iBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;IAC5B,CAAC;IACH,2BAAC;AAAD,CAAC,AAhED,IAgEC;AAhEqB,oDAAoB","sourcesContent":["/**\n * @internalapi\n * @module vanilla\n */ /** */\n\nimport { LocationServices } from \"../common/coreservices\";\nimport { Disposable } from \"../interface\";\nimport { UIRouter } from \"../router\";\nimport { LocationLike, HistoryLike } from \"./interface\";\nimport { parseUrl, getParams, buildUrl } from \"./utils\";\nimport { isDefined } from \"../common/predicates\";\nimport { extend, deregAll, removeFrom } from \"../common/common\";\n/** A base `LocationServices` */\nexport abstract class BaseLocationServices implements LocationServices, Disposable {\n  constructor(router: UIRouter, public fireAfterUpdate: boolean) {\n    this._location = window && window.location;\n    this._history = window && window.history;\n  }\n\n  _listener = evt => this._listeners.forEach(cb => cb(evt));\n\n  private _listeners: Function[] = [];\n  _location: LocationLike;\n  _history: HistoryLike;\n\n  /**\n   * This should return the current internal URL representation.\n   *\n   * The internal URL includes only the portion that UI-Router matches.\n   * It does not include:\n   * - protocol\n   * - server\n   * - port\n   * - base href or hash\n   */\n  abstract _get(): string;\n\n  /**\n   * This should set the current URL.\n   *\n   * The `url` param should include only the portion that UI-Router matches on.\n   * It should not include:\n   * - protocol\n   * - server\n   * - port\n   * - base href or hash\n   *\n   * However, after this function completes, the browser URL should reflect the entire (fully qualified)\n   * HREF including those data.\n   */\n  abstract _set(state: any, title: string, url: string, replace: boolean);\n\n  hash   = () => parseUrl(this._get()).hash;\n  path   = () => parseUrl(this._get()).path;\n  search = () => getParams(parseUrl(this._get()).search);\n\n  url(url?: string, replace: boolean = true): string {\n    if (isDefined(url) && url !== this._get()) {\n      this._set(null, null, url, replace);\n\n      if (this.fireAfterUpdate) {\n        let evt = extend(new Event(\"locationchange\"), { url });\n        this._listeners.forEach(cb => cb(evt));\n      }\n    }\n\n    return buildUrl(this);\n  }\n\n  onChange(cb: EventListener) {\n    this._listeners.push(cb);\n    return () => removeFrom(this._listeners, cb);\n  }\n\n  dispose(router: UIRouter) {\n    deregAll(this._listeners);\n  }\n}\n"]}